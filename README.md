# 人才盘点结果汇总系统

S1人才盘点九宫格分析工具，支持Excel数据上传、自动部门-负责人映射、九宫格分析和PPT报告生成。

## 功能特点

- 📊 **九宫格潜力分析**：自动生成3x3九宫格人才分布图（绩效×潜力维度）
- 👥 **梯队统计**：前5%、前5%-15%、前15%、前15%-40%、前40%、末5%梯队分析
- 🏢 **部门映射**：内置32+部门-负责人自动匹配功能
- 📈 **数据提取**：从"现组织单元全路径"字段智能提取部门信息
- 🎯 **重点关注**：自动识别基干未盘入梯队、专家末5%、专家未盘入梯队人员
- 📋 **PPT报告**：一键生成腾讯风格PPT报告（包含5个页面）
- 🔧 **灵活配置**：支持自定义Excel列名映射和部门-负责人映射

## 支持的Excel格式

系统支持以下列名（可在代码中的`COLUMN_MAPPING`配置调整）：
- `九宫格结果（需输入）` - 九宫格评级（1-9）
- `员工姓名` - 员工姓名
- `现组织单元全路径` - 组织架构完整路径（格式：腾讯/部门名称/...）
- `梯队结果-梯队（需输入）` - 梯队评级（前5%、前5%-15%、前15%、前15%-40%、前40%、末5%）
- `管理职级` - 管理层级（L1、L2等，用于基干识别）
- `专业职级` - 专业层级（格式：类别-级别/类型/S数字，如"技术类-AA/技术/S12"）

## 九宫格说明

### 3×3九宫格矩阵（绩效×潜力）
- **7, 8, 9** → 高潜力（指标：20%）
- **4, 5, 6** → 中潜力（指标：70%）
- **1, 2, 4** → 低潜力（指标：10%）

系统按照绩效（X轴）和潜力（Y轴）两个维度进行员工评估。

### 梯队分类
- **前5%** → 顶尖人才
- **前5%-15%** → 核心人才（上）
- **前15%** → 核心人才（下）
- **前15%-40%** → 骨干人才（上）
- **前40%** → 骨干人才（下）
- **末5%** → 重点关注人员

## 快速开始

### 方法一：本地运行

1. 克隆或下载本项目：
```bash
git clone <your-repo-url>
cd <project-folder>
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行应用：
```bash
streamlit run streamlit_app.py
```
或使用快速启动脚本：
```bash
python run.py
```

4. 打开浏览器访问：http://localhost:8501

### 方法二：云端部署

推荐使用 [Streamlit Community Cloud](https://share.streamlit.io) 进行免费部署：

1. 将代码上传到GitHub仓库
2. 访问 https://share.streamlit.io
3. 连接GitHub账号，选择仓库
4. 指定主文件为 `streamlit_app.py`
5. 自动部署，获得公开访问链接

## 使用说明

### 基本操作
1. **示例数据测试**：勾选"使用示例数据进行测试"查看演示效果（1500人×32部门）
2. **上传真实数据**：上传包含必需列的Excel文件
3. **查看分析结果**：
   - 数据总览：梯队总览和基干九宫格统计
   - 九宫格一览：3×3矩阵展示各档位人员分布
   - 梯队重点关注：基干未盘入梯队、专家末5%、专家未盘入梯队
4. **下载报告**：支持Excel和PPT格式报告下载

### PPT报告内容
生成的PPT包含5个页面：
- **第1页**：腾讯风格封面页
- **第2页**：数据总览（梯队统计 + 九宫格统计）
- **第3页**：九宫格详细一览（3×3矩阵，带坐标轴）
- **第4页**：九宫格5档位详细名单（三栏表格）
- **第5页**：梯队重点关注（三个专题表格）

## 配置说明

### Excel列名映射配置

在 `streamlit_app.py` 文件顶部可以调整Excel列名映射，适配不同的Excel文件格式：

```python
COLUMN_MAPPING = {
    # Excel列名 -> 系统内部列名
    '九宫格结果（需输入）': '档位',
    '员工姓名': '姓名',
    '现组织单元全路径': '当前组织',
    '梯队结果-梯队（需输入）': '梯队',
    '管理职级': '管理职级',
    '专业职级': '专业职级'
}
```

### 部门-负责人映射表

系统内置了完整的部门-负责人映射表，支持自动匹配。映射表包含以下负责人及其管辖部门：

- **leon(郭凯天)**：职能线办公室
- **samxu(徐炎)**：法务相关部门（反洗钱、金融法律、数据合规等10个部门）
- **dega(刘夏耘)**：行政相关部门（行政部、基建部、采购管理部等5个部门）
- **snailcai(蔡光忠)**：大湾区公共事务部、腾讯西南总部
- **leolyliu(刘勇)**：腾讯北京总部、集团公共事务部、CSIG公共事务部
- **cyberchen(陈勇)**：公共事务相关部门（PCG、WXG、文化与内容、数字舆情）
- **lucazhu(朱劲松)**：安全管理部、信息安全发展部
- **jasonsi(司晓)**：反垄断合规部、公共战略研究部、市场经营合规部

可在 `DEPARTMENT_SUPERVISOR_MAPPING` 字典中自定义部门-负责人映射关系。

### 部门提取逻辑

系统从"现组织单元全路径"字段自动提取部门名称：
- 格式示例：`腾讯/部门名称/子部门/...`
- 提取规则：取第一个"/"到第二个"/"之间的内容作为部门名称

### 梯队统计指标

系统内置的梯队指标（可根据实际调整）：
```python
tier_targets = {
    '前5%': 72,      # 5%顶尖人才
    '前15%': 139,    # 10%核心人才（前5%-15%区间）
    '前40%': 351,    # 25%骨干人才（前15%-40%区间）
    '末5%': 72       # 5%重点关注
}
```

### 九宫格统计指标

基干九宫格指标：
- **6/8/9档**：42人（高潜力）
- **1/2/4档**：14人（低潜力）

## 数据分析逻辑

### 九宫格分析
- 只统计有管理职级的人员（基干）
- 按部门分组汇总各档位人员
- 档位5单独生成详细名单页

### 梯队重点关注

系统自动识别以下三类重点关注人员：

1. **基干未盘入梯队**
   - 条件：有管理职级但梯队值不在有效范围内
   - 显示：负责人、部门、姓名、管理职级、备注

2. **专家末5%**
   - 条件：无管理职级 且 专业职级≥S12 且 梯队="末5%"
   - 显示：负责人、部门、姓名、专业职级、备注

3. **专家未盘入梯队**
   - 条件：无管理职级 且 专业职级≥S12 但 梯队值不在有效范围内
   - 显示：负责人、部门、姓名、专业职级、备注

## 技术栈

- **前端框架**：Streamlit 1.28.0+
- **数据处理**：Pandas 1.5.0+
- **Excel处理**：OpenPyXL 3.0.0+
- **PPT生成**：python-pptx 0.6.21+
- **部署平台**：Streamlit Community Cloud / 本地服务器

## 文件结构

```
.
├── streamlit_app.py       # 主应用程序
├── requirements.txt       # Python依赖包列表
├── run.py                # 快速启动脚本
├── README.md             # 项目说明文档
├── LICENSE               # MIT开源许可证
└── .gitignore            # Git忽略文件配置
```

## 版本要求

- Python 3.8+
- Streamlit 1.28.0+
- Pandas 1.5.0+
- OpenPyXL 3.0.0+
- python-pptx 0.6.21+

## 示例数据

系统内置示例数据生成器，包含：
- **总人数**：1500人
- **部门数量**：32个部门
- **负责人数量**：8位负责人
- **管理职级**：120人（L1: 80人，L2: 40人）
- **专业职级**：1380人（S5-S15，其中S12+: 150人）
- **九宫格分布**：仅在管理职级人员中分布
  - 6/8/9档：24人（20%）
  - 1/2/4档：12人（10%）
  - 3/5/7档：84人（70%）
- **梯队分布**：
  - 前5%：75人（5%）
  - 前5%-15%：150人（10%）
  - 前15%-40%：375人（25%）
  - 末5%：75人（5%）
  - 普通员工：825人（55%，无特殊梯队标识）

## 常见问题

### Q1: Excel文件上传后提示缺少必需的列？
**A**: 请检查Excel文件中的列名是否与 `COLUMN_MAPPING` 配置一致。可以在代码中修改映射关系，或调整Excel文件的列名。

### Q2: 部门信息提取不正确？
**A**: 请确保"现组织单元全路径"列的格式为：`腾讯/部门名称/...`。系统会自动提取第二个部分作为部门名称。

### Q3: 负责人显示为"待分配"？
**A**: 说明该部门未在 `DEPARTMENT_SUPERVISOR_MAPPING` 中配置。可以手动添加部门-负责人映射关系。

### Q4: PPT生成失败？
**A**: 请检查是否安装了 `python-pptx` 包。如果已安装，尝试更新到最新版本：
```bash
pip install --upgrade python-pptx
```

### Q5: 如何修改梯队或九宫格的指标？
**A**: 在 `streamlit_app.py` 中搜索 `tier_targets` 和 `create_stats_table` 函数，修改对应的指标数值。

## 更新日志

### v1.3.0 (2024-12)
- ✅ 修正Excel列名映射为实际使用的列名
- ✅ 优化部门提取逻辑，从"现组织单元全路径"提取
- ✅ 新增梯队重点关注功能（基干未盘入、专家末5%、专家未盘入）
- ✅ 完善PPT报告，新增第5页梯队重点关注页面
- ✅ 优化专业职级显示格式（显示为S10、S12等简洁格式）
- ✅ 改进数据验证和错误提示

### v1.2.0 (2024-11)
- 新增从"当前组织"字段提取部门功能
- 新增列名映射配置功能
- 优化PPT报告样式

### v1.1.0 (2024-10)
- 新增部门-负责人自动映射功能
- 新增梯队统计分析

### v1.0.0 (2024-09)
- 初始版本，支持基础九宫格分析
- 支持Excel上传和PPT导出

## 贡献指南

欢迎提交Issue和Pull Request来改进这个项目！

1. Fork本项目
2. 创建您的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开一个Pull Request

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**注意**：本系统为内部人才盘点工具，包含的部门和人员信息仅为示例数据。实际使用时请根据组织实际情况修改配置。